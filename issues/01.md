# broswer-use 功能补充需求文档

## 背景
当前 broswer-use 工具在长时间自动化运行中存在一些稳定性和功能性的问题。为确保其在自动任务执行中的持续性、稳定性及易用性，提出以下功能补充需求。

---

## 功能需求清单

### ✅ 高优先级（P0）

1. **无限循环执行任务**
   - 当前默认最多执行 200 步（step），达到上限后自动退出。
   - **期望行为**：执行完当前 200 步后自动重置，从头开始新一轮任务，直至用户手动停止。

2. **异常 step 重试策略优化**
   - 当前单个 step 连续失败 3 次后程序退出。
   - **期望行为**：即便失败，整体循环不中断，重新开始新一轮任务。

3. **配置文件导入导出持久化**
   - 当前配置需手动填写，每次刷新程序或重启丢失数据。
   - **期望行为**：支持配置持久化，提供导入导出功能，支持临时恢复。

4. **任务停止时卡顿问题**
   - 程序停止任务存在卡顿现象，导致不得不强制重启服务。
   - **期望行为**：平滑终止任务，释放资源，服务保持可用。

5. **任务报表生成与累计**
   - 每次任务循环结束后，自动记录一次执行信息，包括：
     - 执行开始时间
     - 执行时长
     - 所访问的页面链路（依序）
     - 是否完成（成功/失败）
   - 报表支持累计统计：
     - 总计完成 X 次
     - 失败 X 次
     - 总运行时长 XX小时XX分钟
   - 示例格式：
     ```

     执行开始时间: 2025-04-11 09:00:00  

     执行时长: 2min  

     访问页面链路:  

     - https://www.google.com/  

     - https://www.google.com/search?...  

     - https://www.amazon.com/Vibe-Interactive-...  

     是否完成: 是  

     ```

---

### ⚙️ 中优先级（P1）

5. **任务执行日志与目标记录**
   - 每次循环没有记录任务执行情况。
   - **期望行为**：循环结束后记录目标状态、执行情况，输出清晰日志（例如执行成功/失败、目标达成情况等）。

6. **提示词体系优化**
   - 当前提示词质量一般，主要由开发维护。
   - **期望行为**：支持将提示词配置交由运营维护（通过配置文件或管理面板）。

---

### 🧪 低优先级（P2）

7. **服务器性能与稳定性**
   - 在部署于 32B 多台机器时，偶发自动重启。
   - 显卡温度控制在 50-60℃，仍出现崩溃。
   - **建议**：增加 GPU/内存使用情况监控，分析自动重启的系统日志，必要时更换硬件或优化模型推理效率。

8. **模型性能评估**
   - 当前未明确使用哪种模型（如 Claude、GPT-4、Mistral）。
   - **建议**：进行模型间对比评估，确认哪种模型更适合当前业务场景（输出准确率、速度、稳定性、API 成本等维度）。

---

## 结语
优先完成 P0 类问题，将显著提高系统稳定性与任务连续执行能力。中期可通过运营合作提升提示词系统，长期持续关注服务性能和模型选型优化。



```
你是一名具备高级研发能力的自动化系统开发工程师，正在基于开源项目 https://github.com/browser-use/browser-use 进行定制开发。

在任务开始前，你需要：

1. **先读取功能需求清单（见下文）**
2. **使用结构化思维（Sequential Thinking）理解业务目标**
3. **将需求拆解为可执行的模块和函数单元（Software Planning Tool 风格）**

---

### 🧩 当前功能需求清单：

- 无限循环：取消最大 200 step 限制，程序循环运行，直到人为停止
- 容错重试：step 连续失败 3 次不退出，重启新一轮任务
- 配置持久化：支持导入导出配置，避免程序重启丢失状态
- 停止任务稳定性：解决停止任务时的程序卡顿问题
- 执行报表记录：每轮任务结束后记录报表，包括：
  - 执行开始时间
  - 执行时长
  - 页面访问链路
  - 是否完成
- 累计统计：总完成次数 / 总失败次数 / 总运行时长

---

请根据以上需求：

- 阅读并分析 browser-use 源码结构，定位可扩展点
- 拆分出核心模块（如：runner、config、report、logger）
- 输出功能模块设计方案与函数签名
- 提供建议的代码组织与目录结构
- 编写关键逻辑（如报表更新、持久化实现、任务循环控制）

注意：

- 输出应模块化、健壮
- 所有逻辑需支持断点恢复和容错处理
- 使用现代工程习惯设计代码，注重可维护性
```